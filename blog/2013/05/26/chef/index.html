
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>chef - My Octopress Blog</title>
  <meta name="author" content="Your Name">

  
  <meta name="description" content="">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://jordanrs.github.io/blog/2013/05/26/chef">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="My Octopress Blog" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">My Octopress Blog</a></h1>
  
    <h2>A blogging framework for hackers.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:jordanrs.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Chef</h1>
    
    
      <p class="meta">
        








  


<time datetime="2013-05-26T00:00:00+01:00" pubdate data-updated="true">May 26<span>th</span>, 2013</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>Included file &lsquo;JB/setup&rsquo; not found in _includes directory</p>

<p>get a bootstrap cehf-repository from</p>

<p><a href="http://github.com/opscode/chef-repo/tarball/master">http://github.com/opscode/chef-repo/tarball/master</a></p>

<p>and in a .chef folder which has your shared keys, your user keys and your organistion validator key and your knife.rb</p>

<p>Hosted chef server</p>

<p><a href="http://www.agileweboperations.com/amazon-ec2-instances-with-opscode-chef-using-knife">http://www.agileweboperations.com/amazon-ec2-instances-with-opscode-chef-using-knife</a></p>

<p><a href="http://wiki.opscode.com/display/chef/EC2+Bootstrap+Fast+Start+Guide">http://wiki.opscode.com/display/chef/EC2+Bootstrap+Fast+Start+Guide</a></p>

<p>assusme defaults -G &lsquo;default&rsquo; no roles or recipes and will boostrap chef client and ruby on teh server make sure port 22 80 and 443 are open on the server</p>

<p>knife ec2 server create -I ami-7962730d -f t1.micro -S knife -i ~/.ssh/knife.pem &mdash;ssh-user ubuntu &mdash;region eu-west-1 -Z eu-west-1a</p>

<p>add the knife.pem to your ssh agent
ssh-add ~/.ssh/knife.pem</p>

<p>means you can remove the -i ~/.ssh/knife.pem from the command</p>

<p>knife ec2 server create -I ami-7962730d -f t1.micro -S knife &mdash;ssh-user ubuntu &mdash;region eu-west-1 -Z eu-west-1a</p>

<p>knife[:aws_ssh_key_id] = &ldquo;knife&rdquo;</p>

<p>knife ec2 server create -I ami-7962730d -f t1.micro &mdash;ssh-user ubuntu &mdash;region eu-west-1 -Z eu-west-1a</p>

<p>knife[:availability_zone]     = &lsquo;eu-west-1a&rsquo;
knife[:region]                = &lsquo;eu-west-1&rsquo;</p>

<p>knife ec2 server create -I ami-7962730d -f t1.micro &mdash;ssh-user ubuntu</p>

<p>this will create our instance, install chek-client on the server and assocatie the client with the hosted chef server. and will run any recipes or roles we defined. but since we didnt define anything we will have to do this late</p>

<p>so now we have a node / client from out chef server we can begin building up out cookbooks to install our software.</p>

<p>to manage out cookbooks and first gem install berkshelf which is to cookbooks as bundler is to gems</p>

<p>Figure out what software you want on your in this case it is ruby, bundler, nodejs, postgres and nginx</p>

<p>berks upload moves our files to our chef server</p>

<p>rake install &ndash; updates the cookbooks and roles</p>

<p>knife ssh name:i-e41aa4a9 -x ubuntu &ldquo;sudo chef-client&rdquo; this tells our chef client (the server we are configuring) to update its self from the server</p>

<p><a href="http://docs.opscode.com/chef_client.html">http://docs.opscode.com/chef_client.html</a> how to set chef-client up to run as a deamon that by default gets called every</p>

<p>So some cook books wont have a recipe, so how do we get to use them in cookbook</p>

<p>like applciation and application_ruby both have no recipes so we create a new cook book and recipe that dpends on these cook books</p>

<p>depends &ldquo;application&rdquo;
depends &ldquo;application_ruby&rdquo;</p>

<p>when create a server with knife we define it a role such as webserver, we than create a role and define a run list which is the order things will be installed in by chef</p>

<p>name &ldquo;webserver&rdquo;
description &ldquo;basic example&rdquo;
run_list(
  &ldquo;recipe[apt]&rdquo;,
  &ldquo;recipe[build-essential]&rdquo;,
  &ldquo;recipe[nginx]&rdquo;,
  &ldquo;recipe[ruby_build]&rdquo;,
  &ldquo;recipe[example]&rdquo;
)</p>

<p>at the bottom we have our</p>

<p>since we didnt spcify a role when the server was created we can chage this by doing knife node list &ndash; get the identifier and then knife node edit <identifer>  at the bottom</p>

<p>&ldquo;run_list&rdquo;: [
  &ldquo;role[webserver]&rdquo;
]</p>

<p>now when ever we run sudo chef-client configures this as the webserver role</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Your Name</span></span>

      








  


<time datetime="2013-05-26T00:00:00+01:00" pubdate data-updated="true">May 26<span>th</span>, 2013</time>
      


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://jordanrs.github.io/blog/2013/05/26/chef/" data-via="" data-counturl="http://jordanrs.github.io/blog/2013/05/26/chef/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2013/05/16/rspec-caveats/" title="Previous Post: rspec caveats">&laquo; rspec caveats</a>
      
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/05/26/chef/">Chef</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/05/16/rspec-caveats/">Rspec Caveats</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/05/13/facebook-app-specs/">Facebook App Specs</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/05/12/capybara-webkit-and-requests-specs/">Capybara, Webkit and Requests Specs'</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/04/25/installing-guard-and-spork-for-auto-running-of-tests/">Installing Guard and Spork for Auto Running of Specs'</a>
      </li>
    
  </ul>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Your Name -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
