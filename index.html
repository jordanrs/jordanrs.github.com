
<!DOCTYPE HTML>
<html>
<head>
	<meta charset="utf-8">
	<title>Jordan Rogers-Smith</title>
	<meta name="author" content="Jordan Rogers-Smith">

	
	<meta name="description" content="Jul 22nd, 2013 Hacked 2013 Hacked.oi was utterly awesome. In the end myself, Marcello Seri and Ben Oxley created homeFlux, a realtime system for &hellip;">
	

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

	<link href="/atom.xml" rel="alternate" title="Jordan Rogers-Smith" type="application/atom+xml">
	
	<link rel="canonical" href="http://jordanrs.github.io/">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	<link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,400,700' rel='stylesheet' type='text/css'>
	<!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

</head>


<body>
	<div class="container">
		<div class="left-col">
			<div class="intrude-less">
			<header id="header" class="inner"><div class="profilepic">	
	<script src="/javascripts/md5.js"></script>
	<script type="text/javascript">
		$(function(){
			$('.profilepic').append("<img src='http://www.gravatar.com/avatar/" + MD5("jordanrs2k1@gmail.com") + "?s=160' alt='Profile Picture' style='width: 160px;' />");
		});
	</script>
</div>
<hgroup>
  <h1><a href="/">Jordan Rogers-Smith</a></h1>
  
    <h2>Coding away day to day.</h2>
  
</hgroup>


<nav id="main-nav"><ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>
</nav>
<nav id="sub-nav">
	<div class="social">
		
		
		
		<a class="twitter" href="http://twitter.com/JRogersSmith" title="Twitter">Twitter</a>
		
		
		<a class="github" href="https://github.com/jordanrs" title="GitHub">GitHub</a>
		
		
		
		<a class="linkedin" href="http://www.linkedin.com/in/jordanrogerssmith">LinkedIn</a>
		
		
		
		
		
		<a class="rss" href="/atom.xml" title="RSS">RSS</a>
		
	</div>
</nav>
</header>				
			</div>
		</div>	
		<div class="mid-col">
			
				
			
			<div class="mid-col-container">
				<div id="content" class="inner">
<div itemscope itemtype="http://schema.org/Blog">


    <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
	<div class="meta">
		<div class="date">








  


<time datetime="2013-07-22T12:03:00+01:00" data-updated="true" itemprop="datePublished">Jul 22<span>nd</span>, 2013</time></div>
		<div class="tags">

</div>
		
	</div>
	<h1 class="title" itemprop="name"><a href="/blog/2013/07/22/hacked-2013/" itemprop="url">Hacked 2013</a></h1>
	<h2 class="sub_heading" itemprop="name"></h2>
	<div class="entry-content" itemprop="articleBody">
		<p><a href="" title="http://hacked.io">Hacked.oi</a> was utterly awesome. In the end myself, <a href="https://twitter.com/marcelloseri">Marcello Seri</a> and <a href="https://twitter.com/b3noxley">Ben Oxley</a> created <a href="" title="https://www.hackerleague.org/hackathons/hacked/hacks/homeflux">homeFlux</a>, a realtime system for adapting light levels to match a desired intensity and also adjust colour values over time much like <a href="http://justgetflux.com/">flu.x</a>. Was awesome fun.</p>

<p><a href="http://www.youtube.com/watch?feature=player_embedded&v=T_gPdTJkoM0" target="_blank"><img src="http://img.youtube.com/vi/T_gPdTJkoM0/0.jpg" alt="homeFlux Demo Video" width="240" height="180" border="10" /></a></p>

		
		
	</div>

</article>


    <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
	<div class="meta">
		<div class="date">








  


<time datetime="2013-07-10T20:46:00+01:00" data-updated="true" itemprop="datePublished">Jul 10<span>th</span>, 2013</time></div>
		<div class="tags">

</div>
		
	</div>
	<h1 class="title" itemprop="name"><a href="/blog/2013/07/10/activeadmin-form-preview-with-javascript-formdata/" itemprop="url">ActiveAdmin Form Preview With Javascript FormData</a></h1>
	<h2 class="sub_heading" itemprop="name"></h2>
	<div class="entry-content" itemprop="articleBody">
		<p>One of my recent tasks has been to build a preview of a form submission into an existing application. Having done something similar in the past involving changing the forms action with javascript, ajax posting the form (including images), generating a preview, changing the form back blaa blaa blaa blaa blaaaaa. I wanted to find a cleaner way to a) deal with the preview and b) ajaxing blob data (image/files) and thanks to not having to support IE implemented the following procedure using FormData and XMLHttpRequest 2.</p>

<p>FormData is awesome, give it a form including blob data and it&rsquo;ll return an object that can be attached to $.ajax or standard XMLHttpRequest.send and all the caveats and nuiances of ajax forms disappear in the blink of an eye.</p>

<pre><code>// something like
var fd = FormData.new( $('form')[0] );

$.ajax({
  ...
  url: '/iwantdata',
  data: fd, 
  ...
})

// or

var ajax = new XMLHttpRequest();
ajax.open("POST", "/iwantdata");
ajax.send(fd));
</code></pre>

<p>My stratergy then was simple, take more fieldset, clone it, wrap it in a formtag (all in memory), create the formdata object and away we go images and all. So my first attempt looked as follows.</p>

<pre><code>var buildFormData = function($fieldset){
  var $clone = $('#fieldset').clone({ deepWithDataAndEvents: true});
  var $form = $('&lt;form /&gt;).append($clone);
  var fd = new FormData($form[0])
  return fd
};

var sendPreview = function(formData){
  $.ajax({
   url: "/iwantdata",
   type: "POST",
   data: formData,
   processData: false,
   contentType: false,
  }).done(weDidIt);
};
</code></pre>

<p>This worked great at first all the data was being submitted correctly excpet file fields. These werent being copied over at all due to the caveats of browser security and cloning file fields it seems. So instead of doing it all in memory, which would have been the ideal, I had to use the file fields in the DOM but didnt want to have to pull the form apart and put it back together. Even though the html specification has a big NO NO when it comes to nested form tags it is possible to create them with javascript and this is what i did to build my in place subsection FormData.</p>

<pre><code>var buildFormData = function($fieldset){
  var $form = $fieldset.wrap('&lt;form /&gt;').closest('form');
  var fd = new FormData($form[0])
  $fieldset.unwrap();
  return fd
};

var sendPreview = function(formData){
  $.ajax({
   url: "/iwantdata",
   type: "POST",
   data: formData,
   processData: false,
   contentType: false,
  }).done(weDidIt);
};
</code></pre>

<p>Not ideal but this solution was a simple way to create a FormData from a subset of fields on the fly which includes all the file field information also.</p>

		
		
	</div>

</article>


    <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
	<div class="meta">
		<div class="date">








  


<time datetime="2013-06-01T10:27:00+01:00" data-updated="true" itemprop="datePublished">Jun 1<span>st</span>, 2013</time></div>
		<div class="tags">

</div>
		
	</div>
	<h1 class="title" itemprop="name"><a href="/blog/2013/06/01/testing-facebook-login-and-permissions-with-capybara/" itemprop="url">Testing Facebook Login and Permissions With Capybara</a></h1>
	<h2 class="sub_heading" itemprop="name"></h2>
	<div class="entry-content" itemprop="articleBody">
		<p>Having begun to use Capybara and Rspec quiet heavily there have been a few challenges that need to be overcome. One of these is that the applications I develop day to day are heavily intertwined with Facebook and user flow relies heavily on Facebook login and accepting permissions at various points throughout the application.</p>


		
		<a href="/blog/2013/06/01/testing-facebook-login-and-permissions-with-capybara/" class="more-link">Read on &rarr;</a>
	</div>

</article>


    <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
	<div class="meta">
		<div class="date">








  


<time datetime="2013-05-26T00:00:00+01:00" data-updated="true" itemprop="datePublished">May 26<span>th</span>, 2013</time></div>
		<div class="tags">

</div>
		
	</div>
	<h1 class="title" itemprop="name"><a href="/blog/2013/05/26/Learning-Chef-From-Scratch---Building-a-EC2-backed-Rails-Stack-Part-1/" itemprop="url">Learning Chef From Scratch - Building a EC2 Backed Rails Stack Part 1</a></h1>
	<h2 class="sub_heading" itemprop="name">Setup Chef and Creating a EC2 instance</h2>
	<div class="entry-content" itemprop="articleBody">
		<p>Chef is a fantastic tool for automating the process bootstrapping a fresh server so that once you have got it running how you want, replicating that configuration and setup requires very little effort what so ever.</p>

<p>Chef has two different use cases, Chef server (wether that be hosted or private) or Chef Solo. Chef solo allows you to interact directly with the machine your wanting to administrate and is very useful for bootstrapping a vagrant image for instance. Chef Server offers a centralised place for you to push your configurations and recipes so that when working with multiple servers (known as nodes or chef clients) you don&rsquo;t have to update each one individually as each client can be set to poll to server for any updates.</p>

<p>For my first time using chef i through myself straight in at the deep end in that i wanted to put together a full working EC2 instance that would run my usual heroku stack (nginx, unicorn, ruby, rails and postgres). I opted for using Opscodes free Chef hosted plan for my Chef server and got straight to it.</p>


		
		<a href="/blog/2013/05/26/Learning-Chef-From-Scratch---Building-a-EC2-backed-Rails-Stack-Part-1/" class="more-link">Read on &rarr;</a>
	</div>

</article>


    <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
	<div class="meta">
		<div class="date">








  


<time datetime="2013-04-25T00:00:00+01:00" data-updated="true" itemprop="datePublished">Apr 25<span>th</span>, 2013</time></div>
		<div class="tags">

</div>
		
	</div>
	<h1 class="title" itemprop="name"><a href="/blog/2013/04/25/installing-guard-and-spork-for-auto-running-of-tests/" itemprop="url">Installing Guard and Spork for Auto Running of Specs&#8217;</a></h1>
	<h2 class="sub_heading" itemprop="name"></h2>
	<div class="entry-content" itemprop="articleBody">
		<h2>Gemfile</h2>

<p>Install the following gems with <code>bundle install</code></p>

<pre><code>group :test_envs do
  gem 'rspec-rails', "~&gt; 2.0"
  gem 'factory_girl_rails'
  gem 'faker'
  gem 'capybara', "~&gt; 2.0.2"
  gem 'database_cleaner', "~&gt; 0.9.1"
  gem 'launchy'

  # file system event triggers for ruby. See note at end about RVM 
  gem 'rb-fsevent', '0.9.3'

  # Notifications of test states, Requires Growl and growlnotify to be installed
  gem 'growl', '1.0.3'

  # Automated test running and speed imporvements
  gem 'guard-rspec'
  gem 'guard-spork', '1.2.0'
  gem 'childprocess', '0.3.6'# this was due to errors appearing in 0.3.7 and higher
  gem 'spork', '0.9.2'
  gem 'debugger'
end
</code></pre>

<h2>spec/spec_helper</h2>


		
		<a href="/blog/2013/04/25/installing-guard-and-spork-for-auto-running-of-tests/" class="more-link">Read on &rarr;</a>
	</div>

</article>


    <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
	<div class="meta">
		<div class="date">








  


<time datetime="2013-04-23T00:00:00+01:00" data-updated="true" itemprop="datePublished">Apr 23<span>rd</span>, 2013</time></div>
		<div class="tags">

</div>
		
	</div>
	<h1 class="title" itemprop="name"><a href="/blog/2013/04/23/multiple-test-enviroments/" itemprop="url">Multiple Test Environments in Rails</a></h1>
	<h2 class="sub_heading" itemprop="name"></h2>
	<div class="entry-content" itemprop="articleBody">
		<p>Create the file <code>config/enviroments/jordan_test.rd</code> and copy into it the contents of <code>config/enviroments/test.rb</code>
Via command line from application root:  <code>cp config/environments/test.rb config/environments/jordan_test.rb</code></p>

<p>in config/database.yml add your DB settings (assumes using Postgres)</p>

<pre><code>jordan_test:
  adapter: postgresql
  encoding: utf8
  host: localhost
  database: [project_name]_jordan_test
  username: 
  password: 
</code></pre>

<p>Create the new database</p>

<pre><code>rake db:create:all
</code></pre>

<p>add environment to any :test specific gems or gem groups in your gem file</p>

<pre><code>group :test, :jordan_test do
    #blaaaaa........
end
</code></pre>

<p>or make a bundler group in application.rb so others envs can be added easier.</p>

<pre><code>if defined?(Bundler)
  # If you precompile assets before deploying to production, use this line
  Bundler.require(*Rails.groups(:assets =&gt; %w(development test steve cronin sexyjordan_test), :test_envs =&gt; %w(test sexyjordan_test)))
  # If you want your assets lazily compiled in production, use this line
  # Bundler.require(:default, :assets, Rails.env)
end   
</code></pre>

<p>Usual run rake <code>db:test:prepare</code> or <code>db:test:clone</code> instead possible to run <code>rake db:migrate RAILS_ENV=jordan_test</code> perhaps make an alias for this in your .bash_profile</p>

		
		
	</div>

</article>


    <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
	<div class="meta">
		<div class="date">








  


<time datetime="2013-04-05T00:00:00+01:00" data-updated="true" itemprop="datePublished">Apr 5<span>th</span>, 2013</time></div>
		<div class="tags">

</div>
		
	</div>
	<h1 class="title" itemprop="name"><a href="/blog/2013/04/05/strong-parameters-and-tolk-gem/" itemprop="url">Strong Parameters and Tolk Gem</a></h1>
	<h2 class="sub_heading" itemprop="name"></h2>
	<div class="entry-content" itemprop="articleBody">
		<p>To get the tolk gem to work along side the Strong Parameters gem we need to apply a monkey patch to tolk</p>

<pre><code>in config/initalizers/tolk.rb

Tolk::LocalesController.class_eval do  
    def create
      Tolk::Locale.create!(params[:tolk_locale].try(:permit!))
      redirect_to :action =&gt; :index
    end
end
</code></pre>

		
		
	</div>

</article>


    <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
	<div class="meta">
		<div class="date">








  


<time datetime="2013-02-21T00:00:00+00:00" data-updated="true" itemprop="datePublished">Feb 21<span>st</span>, 2013</time></div>
		<div class="tags">

</div>
		
	</div>
	<h1 class="title" itemprop="name"><a href="/blog/2013/02/21/making-a-gem/" itemprop="url">Making a Gem</a></h1>
	<h2 class="sub_heading" itemprop="name"></h2>
	<div class="entry-content" itemprop="articleBody">
		<p>As to not forget the process of packaging up a gem and putting it on my own hosting just follow these simple tests :&ndash;</p>

<p>1) Firstly make sure the <code>PROJECT_NAME.gemspec</code> file is up to date and you have updated the <code>version.rb</code> file to the correct version.</p>

<p>2) run the command <code>gem build mention-tagger.gemspec</code> or <code>rake build</code>
that should put a gem file in the root directory with the name <code>PROJECT_NAME-VERSION.gem</code> or in <code>pkg/PROJECT_NAME-VERSION.gem</code></p>

<p>To publish to your own gem host</p>

<p>1) First set up geminabox as per these <a href="https://github.com/cwninja/geminabox">instructions</a></p>

<ul>
<li>gem install geminabox</li>
</ul>


<p>2) then gem inabox <code>PROJECT_NAME-VERSION.gem</code></p>

<p>it&rsquo;ll ask for url</p>

<p>3) put in your gem host</p>

<p>and away she goes</p>

<h2>Get it straight from git</h2>

<p>Two ways</p>

<ol>
<li>gem &lsquo;rails&rsquo;, :git => &lsquo;git://github.com/rails/rails.git&rsquo;</li>
</ol>


<p>or equivalently</p>

<ol>
<li>gem &lsquo;rails&rsquo;, :githib => &lsquo;rails/rails&rsquo;</li>
</ol>


<p>which is just <em>USERNAME/PROJECT_NAME</em></p>

		
		
	</div>

</article>


    <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
	<div class="meta">
		<div class="date">








  


<time datetime="2013-02-12T00:00:00+00:00" data-updated="true" itemprop="datePublished">Feb 12<span>th</span>, 2013</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/reminders/'>reminders</a>


</div>
		
	</div>
	<h1 class="title" itemprop="name"><a href="/blog/2013/02/12/activeadmin---customising-export-links/" itemprop="url">ActiveAdmin - Customising Export Links</a></h1>
	<h2 class="sub_heading" itemprop="name">Removing JSON/XML</h2>
	<div class="entry-content" itemprop="articleBody">
		<p>When using active admin there doesn&rsquo;t seem to be an easy way to format the output of the JSON and XML export options like you can with the CSV option.</p>

<p>A nice patch by <a href="https://coderwall.com/p/qzlssg">David Collom</a> allows us to customise what is displayed rather then just hiding it in CSS. The patch is as follows and i just placed it at the top of one of my <code>admin/###.rb</code> files</p>

<pre><code>module ActiveAdmin
  module Views
    class PaginatedCollection
      def build_pagination_with_formats(options)
        div :id =&gt; "index_footer" do
          build_pagination
          div(page_entries_info(options).html_safe, :class =&gt; "pagination_information")
          build_download_format_links([:csv]) unless @download_links == false
        end
      end
    end
  end
end
</code></pre>

<p>To customise what is displayed simplay change the array passing into <code>build_download_format_links()</code></p>

<pre><code>build_download_format_links([:csv]) 
build_download_format_links([:csv, :json])
</code></pre>

		
		
	</div>

</article>


    <article class="post" itemprop="blogPost" itemscope itemtype="http://schema.org/BlogPosting">
	<div class="meta">
		<div class="date">








  


<time datetime="2013-02-10T00:00:00+00:00" data-updated="true" itemprop="datePublished">Feb 10<span>th</span>, 2013</time></div>
		<div class="tags">


	<a class='category' href='/blog/categories/reminders/'>reminders</a>


</div>
		
	</div>
	<h1 class="title" itemprop="name"><a href="/blog/2013/02/10/s3-static-assets-group-policy/" itemprop="url">S3 Static Assets Group Policy</a></h1>
	<h2 class="sub_heading" itemprop="name"></h2>
	<div class="entry-content" itemprop="articleBody">
		<p>I always struggle to remember / find the group security policy for an S3 bucket to make all files available to the public.</p>

<pre><code>{
    "Version": "2008-10-17",
    "Statement": [
        {
            "Sid": "AllowPublicRead",
            "Effect": "Allow",
            "Principal": {
                "AWS": "*"
            },
            "Action": "s3:GetObject",
            "Resource": "arn:aws:s3:::BUCKET-NAME/*"
        }
    ]
}
</code></pre>

<p>The only thing that can be changed is the BUCKET-NAME, leave all other aspects of the policy the same.</p>

		
		
	</div>

</article>

</div>
<nav id="pagenavi">
    
    
        <a href="/blog/page/2/" class="next">Next</a>
    
    <div class="center"><a href="/blog/archives">Blog Archives</a></div>
</nav></div>
			</div>
			<footer id="footer" class="inner"><p>
  Copyright &copy; 2013 - Jordan Rogers-Smith -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

Design credit: <a href="http://shashankmehta.in/archive/2012/greyshade.html">Shashank Mehta</a></footer>
			<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->


<script type="text/javascript">
      var disqus_shortname = 'jordanrs-blog';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>






		</div>
	</div>
</body>
</html>
